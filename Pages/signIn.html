<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Parking Pal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="../Styles/index.css">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1234567890123456" crossorigin="anonymous"></script>
</head>
<body>
    <nav class="navbar bg-mPurple">
        <div class="container-fluid">
            <div class="navbar-nav mx-auto">
                <a href="../index.html" class="navbar-brand text-white text-decoration-none d-flex align-items-center">
                    <img src="../Images/ParkPalLogo.png" alt="Parking Pal Logo" height="40" class="me-2">
                    <h1 id="header" class="mb-0 fw-bold">Parking Pal</h1>
                </a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#Menu" aria-controls="Menu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="Menu">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./parkingPal.html">Parking Pal</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./spotSwap.html">Spot Swap</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./viewRequests.html">View Requests</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./signIn.html">Sign In</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./makeAccount.html">Create Account</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="./meetTheTeam.html">Meet the Team</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Top Banner Ad -->
    <div class="container-fluid bg-light py-2">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-12 text-center">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-1234567890123456"
                         data-ad-slot="1234567900"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card shadow purple-border">
                    <div class="card-body">
                        <h2 class="card-title text-center mb-4">Sign In</h2>
                        <form id="signInForm">
                            <div class="mb-3">
                                <label for="accountName" class="form-label">Account Name</label>
                                <input type="text" class="form-control" id="accountName" placeholder="Enter your account name" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" placeholder="Enter your password" required>
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">Sign In</button>
                            </div>
                        </form>
                        
                        <div class="alert alert-danger mt-3" id="errorMessage" style="display: none;">
                            <strong>Sign In Failed!</strong> <span id="errorText"></span>
                        </div>
                        
                        <div class="alert alert-success mt-3" id="successMessage" style="display: none;">
                            <strong>Welcome back!</strong> You have successfully signed in.
                        </div>
                        
                        <div class="text-center mt-3">
                            <p class="mb-0">Don't have an account? <a href="./makeAccount.html">Create one here</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    
    <script>
        // Check if account exists and password matches
        function validateSignIn(accountName, password) {
            const accounts = JSON.parse(localStorage.getItem('parkingAccounts') || '[]');
            const account = accounts.find(acc => 
                acc.name.toLowerCase() === accountName.toLowerCase() && 
                acc.password === password
            );
            return account;
        }

        // Handle form submission
        document.getElementById('signInForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const accountName = document.getElementById('accountName').value.trim();
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');
            const successMessage = document.getElementById('successMessage');
            const errorText = document.getElementById('errorText');
            
            // Hide previous messages
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
            
            // Check if account name is provided
            if (!accountName) {
                errorText.textContent = 'Please enter your account name.';
                errorMessage.style.display = 'block';
                return;
            }
            
            // Check if password is provided
            if (!password) {
                errorText.textContent = 'Please enter your password.';
                errorMessage.style.display = 'block';
                return;
            }
            
            // Validate credentials
            const account = validateSignIn(accountName, password);
            
            if (account) {
                // Store current user in session
                sessionStorage.setItem('currentUser', JSON.stringify(account));
                
                // Show success message
                successMessage.style.display = 'block';
                
                // Redirect to parking pal after a short delay
                setTimeout(() => {
                    window.location.href = './parkingPal.html';
                }, 1500);
            } else {
                errorText.textContent = 'Invalid account name or password. Please try again.';
                errorMessage.style.display = 'block';
            }
        });

        // Real-time validation feedback
        document.getElementById('accountName').addEventListener('input', function() {
            const accountName = this.value.trim();
            const accounts = JSON.parse(localStorage.getItem('parkingAccounts') || '[]');
            const accountExists = accounts.some(acc => acc.name.toLowerCase() === accountName.toLowerCase());
            
            if (accountName && !accountExists) {
                this.classList.add('is-invalid');
            } else {
                this.classList.remove('is-invalid');
            }
        });
    </script>
</body>
</html>
